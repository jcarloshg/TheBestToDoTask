### Auth Endpoints Testing
###
### Token Handling:
### - Login: Returns accessToken in body, refreshToken in HTTP-only cookie
### - Refresh: Receives refreshToken from HTTP-only cookie, returns new accessToken in body
###           and new refreshToken in HTTP-only cookie
### - HTTP-only cookies are automatically managed by the client
###
### IMPORTANT: For REST Client extension in VS Code:
### 1. Cookies are automatically stored and sent with subsequent requests
### 2. Run the Login endpoint first to set the refreshToken cookie
### 3. Then immediately run the Refresh Token endpoint
### 4. The cookie will be automatically included in the request headers

@baseUrl = http://localhost:3001
@contentType = application/json

### Health Check
GET {{baseUrl}}/health

###
### Sign Up - Create a new user
POST {{baseUrl}}/v1/auth/register
Content-Type: {{contentType}}

{
  "email": "user@example.com",
  "password": "securePassword123"
}

###
### Sign Up - Invalid email format
POST {{baseUrl}}/v1/auth/register
Content-Type: {{contentType}}

{
  "email": "invalid-email",
  "password": "securePassword123"
}

###
### Sign Up - Password too short (less than 8 characters)
POST {{baseUrl}}/v1/auth/register
Content-Type: {{contentType}}

{
  "email": "test@example.com",
  "password": "short"
}

###
### Login - Valid credentials
### Response: { status: "success", data: { accessToken: "...", user: {...} } }
### Cookie: refreshToken set as HTTP-only cookie (7 days expiry)
POST {{baseUrl}}/v1/auth/login
Content-Type: {{contentType}}

{
  "email": "user@example.com",
  "password": "securePassword123"
}

###
### Login - Non-existent user
POST {{baseUrl}}/v1/auth/login
Content-Type: {{contentType}}

{
  "email": "nonexistent@example.com",
  "password": "securePassword123"
}

###
### Login - Wrong password
POST {{baseUrl}}/v1/auth/login
Content-Type: {{contentType}}

{
  "email": "user@example.com",
  "password": "wrongPassword"
}

###
### Refresh Token - Get new access token
### IMPORTANT: Run the "Login - Valid credentials" endpoint FIRST before running this
### The refreshToken cookie from login will be automatically sent with this request
### Response: { status: "success", data: { accessToken: "..." } }
### Cookie: refreshToken updated (auto-rotation) in HTTP-only cookie
POST {{baseUrl}}/v1/auth/refresh-token
Content-Type: {{contentType}}

###
### Refresh Token - No refresh token cookie (should fail)
### This will return 401 error "Refresh token not found"
### Only works if refreshToken cookie is NOT set (e.g., after clearing cookies or new session)
POST {{baseUrl}}/v1/auth/refresh-token
Content-Type: {{contentType}}
